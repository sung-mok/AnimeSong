<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>재생연습6</title>
    <style>
        body,
        html {
            height: 100%;
            margin: 0;
            font-family: Arial, sans-serif;
        }

        body {
            overflow-x: hidden;
        }

        .phase {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.5s;
            transform: translateX(100vw);
        }

        .phase1 {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            flex-direction: row;
            justify-content: flex-start;
            align-items: center;
        }

        .song-info {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: #fff;
            border-radius: 5px;
            font-weight: bold;
            font-size: 14px;
            display: none;
        }

        .phase0 {
            transform: translateX(0);
        }

        .slide-out {
            transform: translateX(-100vw) !important;
        }

        img {
            max-width: 100%;
            max-height: 100%;
        }

        .loading-indicator {
            border: 16px solid #f3f3f3;
            border-top: 16px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .phase2 {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .phase2 img.frame {
            width: 30%;
            margin-bottom: 20px;
        }

        .phase2 img.play-button {
            width: 15%;
        }

        .mode-indicator {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 5px 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: #fff;
            border-radius: 5px;
            font-weight: bold;
        }

        .progress-container {
            width: 70%;
            height: 5px;
            background: #eee;
            margin: 15px 0;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: #3498db;
        }

        .song-count {
            position: absolute;
            bottom: 10px;
            left: 10px;
            padding: 5px 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: #fff;
            border-radius: 5px;
            font-weight: bold;
        }

        .options-container {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }

        .option {
            padding: 10px 20px;
            margin: 0 10px;
            border: none;
            background-color: #3498db;
            color: #fff;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .option:hover {
            background-color: #2980b9;
        }

        .play-button {
            cursor: pointer;
        }

        #signpost {
            max-width: 50%;
            max-height: 50%;
            margin-left: 10px;
        }

        @media screen and (max-width: 1024px) and (min-width: 769px) {
            .phase2 img.frame {
                width: 50%;
            }

            .phase2 img.play-button {
                width: 25%;
            }
        }

        @media screen and (max-width: 768px) {
            .phase2 img.frame {
                width: 70%;
            }

            .phase2 img.play-button {
                width: 35%;
            }

            #signpost {
                max-width: 70%;
                max-height: 70%;
            }
        }

        @media screen and (max-width: 480px) {
            .phase2 img.frame {
                width: 90%;
            }

            .phase2 img.play-button {
                width: 45%;
            }
        }
    </style>
</head>

<body>

    <div id="app">
        <div class="phase phase0" style="background-color: black;">
            <div class="loading-indicator"></div>
        </div>

        <div class="phase phase1">
            <img id="signpost" src="images/signpost.png">
            <div class="song-info">Now Playing: <span id="song-name">Loading...</span></div>
        </div>

        <div class="phase phase2">
            <img class="frame" src="images/album-frame.png">
            <img class="play-button" src="images/play-button.png" onclick="togglePlay()">
            <div class="progress-container">
                <div class="progress-bar"></div>
            </div>
            <div class="song-count">Song <span id="song-number">0</span> of <span id="total-songs">0</span></div>
            <div class="options-container">
                <button class="option" onclick="playNextSong()">Next</button>
                <button class="option" onclick="playPreviousSong()">Previous</button>
            </div>
        </div>
    </div>

    <script>
        let phase = 0;
        let songList = [];
        let currentSongIndex = 0;
        let player;
        let songData;
        let isPlaying = false;
        let shuffleMode = false;
        let intervalId;

        async function initializeApp() {
            const res = await fetch('songList.json');
            songData = await res.json();
            songList = songData.songs;
            document.getElementById('total-songs').innerText = songList.length;
            loadYoutubeApi();
            moveNextPhase();
            updateSongInfo();
            updateSongCount();
        }

        function loadYoutubeApi() {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        }

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '390',
                width: '640',
                videoId: songList[currentSongIndex].id,
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function onPlayerReady(event) {
            event.target.playVideo();
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                isPlaying = true;
                startProgressUpdate();
            } else if (event.data === YT.PlayerState.PAUSED) {
                isPlaying = false;
                stopProgressUpdate();
            } else if (event.data === YT.PlayerState.ENDED) {
                playNextSong();
            }
        }

        function togglePlay() {
            if (isPlaying) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }

        function moveNextPhase() {
            if (phase >= 2) return;
            const currentPhase = document.querySelector(`.phase${phase}`);
            currentPhase.classList.add('slide-out');
            phase++;
            const nextPhase = document.querySelector(`.phase${phase}`);
            nextPhase.classList.add('phase0');
        }

        function updateSongInfo() {
            document.getElementById('song-name').innerText = songList[currentSongIndex].name;
        }

        function updateSongCount() {
            // The function content seems to be missing. Add the required logic here.
        }
    </script>

</body>

</html>
