<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>웹 사이트</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .phase {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: absolute;
            top: 0;
            left: 0;
            transition: transform 1s;
        }

        #phase1 {
            transform: translateX(0);
        }

        #phase2 {
            transform: translateX(-100%);
        }

        .phase img {
            max-width: 100%;
            max-height: 100%;
        }

        #phase2 img {
            width: 25%;
        }

        .progress-bar {
            width: 50%;
            height: 10px;
            background-color: #DDD;
            position: relative;
            margin-top: 20px;
        }

        .progress-bar-inner {
            width: 0;
            height: 100%;
            background-color: #007BFF;
            position: absolute;
            left: 0;
            top: 0;
        }

    </style>

    <!-- YouTube API 스크립트 -->
    <script src="https://www.youtube.com/iframe_api"></script>

    <script>
        let player;
        let currentFrame = 0;
        const totalFrames = 35;
        let animationInterval;
        let isAnimating = false;


        function updateStatusText() {
          const statusText = document.getElementById('statusText');
          statusText.textContent = isAnimating ? '재생' : '일시정지';
        }

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '0',
                width: '0',
                videoId: 'qR6dzwQahOM',
                playerVars: {
                    'autoplay': 0,
                    'controls': 0,
                    'showinfo': 0,
                    'modestbranding': 1,
                    'loop': 1,
                    'playlist': 'qR6dzwQahOM',
                    'fs': 0,
                    'cc_load_policy': 0,
                    'iv_load_policy': 3,
                    'autohide': 0
                }
            });
        }

        function switchPhase(event) {
          const img = event.target;
          const rect = img.getBoundingClientRect();

          const x = event.clientX - rect.left;
          const y = event.clientY - rect.top;

          const minX = 132;
          const minY = 148;
          const maxX = 388;
          const maxY = 232;

          if (x >= minX && x <= maxX && y >= minY && y <= maxY) {
              const phase1 = document.getElementById('phase1');
              const phase2 = document.getElementById('phase2');
              phase1.style.transform = 'translateX(-100%)';
              phase2.style.transform = 'translateX(0)';

              // 페이즈2로 넘어갈 때 기본 상태를 정지 상태로 설정
              const playIcon = document.querySelector('.play-icon');
              const pauseIcon = document.querySelector('.pause-icon');
              clearInterval(animationInterval);
              player.pauseVideo();
              playIcon.style.display = 'block';
              pauseIcon.style.display = 'none';
              isAnimating = false;
          }
      }
     function animateTape() {
        const tapeImage = document.getElementById('tapeImage');
        if (currentFrame > totalFrames) {
            currentFrame = 0;
        }
        tapeImage.src = `tape_frame/frame_${currentFrame}.png`;
        currentFrame++;
    
        if (isAnimating) {
            requestAnimationFrame(animateTape);
        }
    }
    
    function toggleAnimation() {
        const playIcon = document.querySelector('.play-icon');
        const pauseIcon = document.querySelector('.pause-icon');
    
        if (isAnimating) {
            player.pauseVideo();
            playIcon.style.display = 'block';
            pauseIcon.style.display = 'none';
        } else {
            requestAnimationFrame(animateTape);
            player.playVideo();
            playIcon.style.display = 'none';
            pauseIcon.style.display = 'block';
        }
        isAnimating = !isAnimating;
    
        updateStatusText();
    }

      function onPlayerReady(event) {
          // 아무것도 하지 않도록 변경 (이전에는 자동재생을 막는 코드가 있었음)
      }

    </script>

</head>
<body>
    <div class="phase" id="phase1">
        <img src="signpost.png" alt="푯말 이미지" onclick="switchPhase(event)">
    </div>
    <div class="phase" id="phase2">
        <div id="statusText" style="position: absolute; top: 10px; left: 10px;">일시정지</div>
        <img src="tape_frame/frame_0.png" alt="테이프 이미지" id="tapeImage" onclick="toggleAnimation()">
        <img src="재생버튼.png" alt="재생 버튼" class="play-icon" onclick="toggleAnimation()">
        <img src="일시정지버튼.png" alt="일시정지 버튼" class="pause-icon" onclick="toggleAnimation()">
        <div class="progress-bar">
            <div class="progress-bar-inner"></div>
        </div>
    </div>

    <!-- YouTube 플레이어 (화면에 보이지 않도록 설정) -->
    <div id="player" style="display:none;"></div>
</body>
</html>
